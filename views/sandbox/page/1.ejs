<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>個人情報管理ページ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h2>ログイン</h2>
    <form id="loginForm">
        <label for="loginUsername">ユーザー名:</label>
        <input type="text" id="loginUsername" name="loginUsername" required><br>
        <label for="loginPassword">パスワード:</label>
        <input type="text" id="loginPassword" name="loginPassword" required><br>
        <button type="button" onclick="login()">ログイン</button>
    </form>
    <div id="profile" style="display:none;">
        <h2>個人情報</h2>
        <p>ようこそ、<span id="usernameDisplay"></span>さん！</p>
        <p>レアシード: <span id="personalInfo"></span></p>
        <button onclick="logout()">ログアウト</button>
    </div>
    <script>
        var username = '麤';
        var encryptedPassword = 'c2lrYWRlZXI1MTg=';
        var encryptedPersonalInfo = 'QmxOM0ZublM4RjY=';
        
        function decrypt(data) {
            return atob(data);
        }        

        localStorage.setItem('username', username);
        localStorage.setItem('password', encryptedPassword);
        localStorage.setItem('personalInfo', encryptedPersonalInfo);

        var lockoutTime = 10 * 60 * 1000;

        window.onload = function() {
            checkLockout();
        }

        function checkLockout() {
            var lockoutExpiration = localStorage.getItem('lockoutExpiration');
            if (lockoutExpiration && new Date() < new Date(lockoutExpiration)) {
                showLockoutAlert();
            }
        }

        function showLockoutAlert() {
            var lockoutExpiration = new Date(localStorage.getItem('lockoutExpiration'));
            var now = new Date();
            var remainingTime = lockoutExpiration - now;

            if (remainingTime > 0) {
                var remainingMinutes = Math.ceil(remainingTime / 1000 / 60);
                alert('現在ロックアウト中です。残り時間: ' + remainingMinutes + '分');
                setTimeout(showLockoutAlert, 60 * 1000);
            }
        }

        function login() {
            var lockoutExpiration = localStorage.getItem('lockoutExpiration');
            if (lockoutExpiration && new Date() < new Date(lockoutExpiration)) {
                showLockoutAlert();
                return;
            }

            var loginUsername = document.getElementById('loginUsername').value;
            var loginPassword = document.getElementById('loginPassword').value;

            var storedUsername = localStorage.getItem('username');
            var storedEncryptedPassword = localStorage.getItem('password');
            var storedEncryptedPersonalInfo = localStorage.getItem('personalInfo');

            var storedPassword = "wakame";

            if (loginUsername === storedUsername && loginPassword === storedPassword) {
                alert('ログイン成功！');
                document.getElementById('usernameDisplay').innerText = storedUsername;
                document.getElementById('personalInfo').innerText = decrypt(storedEncryptedPersonalInfo);
                document.getElementById('profile').style.display = 'block';
                document.getElementById('loginForm').style.display = 'none';
                localStorage.removeItem('lockoutExpiration');
                localStorage.removeItem('loginAttempts');
            } else {
                var loginAttempts = Number(localStorage.getItem('loginAttempts')) || 0;
                loginAttempts++;
                localStorage.setItem('loginAttempts', loginAttempts);

                if (loginAttempts >= 5) {
                    var lockoutExpirationTime = new Date(new Date().getTime() + lockoutTime);
                    localStorage.setItem('lockoutExpiration', lockoutExpirationTime);
                    showLockoutAlert();
                } else {
                    alert('ユーザー名またはパスワードが違います。残り試行回数: ' + (5 - loginAttempts));
                }
            }
        }

        function logout() {
            document.getElementById('profile').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            localStorage.removeItem('loginAttempts');
            localStorage.removeItem('lockoutExpiration');
        }
    </script>
</body>
</html>